<!DOCTYPE html5>
<!--Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew Brew BTW this is just to annoy TTR...-->
<meta name="viewport" content="width=device-width, initial-scale=1.0"> <!--Helps with mobile compatibility-->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="windows.css">


<title>NPA Website</title>
<style>
    body{background-color:black;}/*Loads before the password loads, so the screen is black before*/
</style>
<a id="top"></a>
<script src="windows.js"></script>
<script src="dashboard.js"></script>
<script src="https://unpkg.com/node-forge@0.7.0/dist/forge.min.js"></script>
        <script>var passMode = '1';
//This is the code for the username and password code.
function loadFile(filePath) {//https://stackoverflow.com/a/41133213/9654083
  result = null;
  xmlhttp = new XMLHttpRequest();
  xmlhttp.open("GET", filePath, false);
  xmlhttp.send();
  if (xmlhttp.status == 200) {
    result = xmlhttp.responseText;
  }
	if (result === null || xmlhttp.status != 200) {
		alert("Fatal error - aborting!");for (;;) {void(0)}}
  return result;
}
function LoginFunction() {
  window.uname = null;//https://stackoverflow.com/a/8348522/9654083
  var pass = null;
  window.uname = prompt("Enter your username...");//https://www.w3schools.com/jsref/met_win_prompt.asp
  var pass = prompt("Enter your password...");//todo: make this an input box thingy html
  const PASSES = loadFile("PASSES.json"); //i hate json but https://www.w3schools.com/js/js_json_parse.asp
  var md = forge.md.sha256.create();
	if (xmlhttp.status != 200) {
        alert("Fatal error - aborting!");for (;;) {void(0)}}
  try {//https://www.w3schools.com/jsref/jsref_try_catch.asp
      md.update(pass);
  } catch(TypeError) { console.log("gotcha");window.location.href="npa7855TRMTTR.html";}
  console.log(md.digest().toHex());
  var obj = JSON.parse(PASSES);
  console.log(uname);
  if( typeof pass === 'undefined' || pass === null ){
  	console.log("gotcha");
  	window.location.href="index.html";}
  for (i in obj) {//https://www.w3schools.com/js/js_json_objects.asp
    if (i === uname) {
      if (obj[i] === md.digest().toHex()) {
  			return false;//https://code-boxx.com/abort-javascript-execution/
            //document.write("Oops! Wrong username/password. They are case sensitive, so watch out for that.")
        }
  	}}
    alert("Welcome to the NPA");window.location.href="npa7855TRMTTR.html";throw new Error("Logged in successfully, killing JavaScript function.");//https://stackoverflow.com/a/51311966/9654083window.location.href = "../index.html";
}
</script>

<script type="text/javascript">
//This is the function for the npa master passWord
function passWord() {
var pass1 = 1;
while (pass1 != "11073641") {
	var pass1 = prompt('Enter master password','');
  console.log(pass1)
  if (pass1 === null || pass1 == 1) {
    console.log("Cancelled");
    window.location.href="npalog.html"; //break out of the function early
      }
    }}

LoginFunction() //Runs the pass/user on page load
passWord() //Runs the password thing on page load
$('.login').hide(); //Hides the login box


document.addEventListener('contextmenu', event => event.preventDefault()); //Disables right click so people cant copy/paste

//The button on the login window
function login() {
  console.log(passMode)
  if (window.passMode === 'lock') {
      passWord();
  } else {
      if (window.passMode === "full") {
          LoginFunction()
      } else {
          LoginFunction()
          passWord()
        }
    }
  $('.login').hide();
}

function hideAll() {//Hides all Windows
  $('.mainWindow').hide();
  $('.securityWindow').hide();
  $('.qrScanWindow').hide();
  $('.qrCodeWindow').hide();
  $('.todoWindow').hide();
  $('.linksWindow').hide();
}
//Keybinds
$(document).on('keydown', function ( e ) { //Lock CTRL + L
    if ((e.metaKey || e.ctrlKey) && ( String.fromCharCode(e.which).toLowerCase() === 'l') ) {
      passMode = "lock";
      $('.login').show();
	    if (xmlhttp.status != 200) {
        alert("Fatal error - aborting!");for (;;) {void(0)}}
    }
});
$(document).on('keydown', function ( e ) { //Fake NPA and LOCK CTRL + F
    if ((e.metaKey || e.ctrlKey) && ( String.fromCharCode(e.which).toLowerCase() === 'f') ) {
      passMode = "lock";
      $('.login').show();
      window.open('npa7855TRMTTR.html','_blank');
    }
});
</script>


<!--THIS IS THE ACTUAL START OF THE FILE AFTER THE PASSWORDS LOAD IN-->
<link rel="stylesheet" type="text/css" href="npaFont.woff2" /> <!--imports the NPA font (gnome GUI font) from the online link-->
<link rel="stylesheet" type="text/css" href="menuss.css">
	<script>if (window.uname === null || typeof(window.uname) === "undefined") {
		console.log(4);for (;;) {void(0)}}</script>
<!--This is the menu-->
<div class="menuContainer">
  <div class="menu">
    <div class="dropupDiv">
      <a href="#main" onclick="hideAll(); $('.mainWindow').show();CurrentIframeThingy = 1;"class="main dropupButton">Main</a>
      <div class="dropup"> <!--https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_dropup_hover-->
        <a href="npa7855TRMTTR.html" target="_blank">Fake NPA</a>
      </div>
    </div>
    <a href="#se" class="main" onclick="hideAll(); $('.securityWindow').show();CurrentIframeThingy = 'security';">Security</a>
    <a href="#todo" class="main" onclick="hideAll(); $('.todoWindow').show();CurrentIframeThingy = 'todo';">TODO</a> <!--The onclick will hide all the windows-->
    <div class="dropupDiv">
      <a href="#qr1" class="main dropupButton" onclick="hideAll(); $('.qrScanWindow').show();CurrentIframeThingy = 1;">QR Code Scanner</a>
      <div class="dropup"> <!--https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_dropup_hover-->
        <a href="https://qrcodescan.in/" target="qr1" onclick="location.href='#qr'">Load QR Scanner</a>
        <a href="#qr2" onclick="hideAll(); $('.qrCodeWindow').show();CurrentIframeThingy = 1;">QR Maker</a>
        <a href="https://www.qr-code-generator.com/" target="qr2" onclick="location.href='#qr'">Load QR Maker</a>
      </div>
    </div>
    <a href="#progs" class="main" onclick="hideAll(); $('.linksWindow').show();CurrentIframeThingy = 1;">Links</a>
    <div class="dropupDiv LOdropupDiv">
      <a href="#top" onclick="passMode = 'lock'; $('.login').show();" class="logoot dropupButton LOdropupButton">Lock</a>
      <div class="dropup LOdropup"> <!--https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_dropup_hover-->
        <a href="npalog.html">Logout</a>
        <a onclick="passMode = 'full'; $('.login').show();">User Pass</a> <!--no var since having a var passmode = lock; means it is a local variable.-->
      </div>
    </div>
  </div>
</div>

<!--Logins-->
<div class="login">
  <div class="loginBox">
    <a onclick=login()>Login</a>
  </div>
</div>

<!--Top bar-->
<div class="topbar">
  <a class="windowSpecificMenu"><script>//Put vars here</script></a>
  <a class="whoLoggedIn" onclick="if (confirm('Switch Users? This will reload the page.')) {window.location.reload(true)} else {}">Logged in as <script>document.write(uname)</script></a>
  <a onclick="ReloadFrameEh(CurrentIframeThingy);" class="reload">Reload Current Program</a>
</div>


<div class="window mainWindow">
      <font size=6>NPA website</font>
        <script>
  		console.log(5);
  		console.log(uname);
  		if (uname === "TheTechRobo") { document.body.innerHTML += Secu;}else if (uname === "TheRuntingMuumuu") { document.body.innerHTML += Misc;}
  	</script><!--https://thisinterestsme.com/add-html-body-javascript/ https://stackoverflow.com/a/8348522/9654083-->
    </p>
</div>



<div class="window securityWindow">
  <iframe src="security.html" width="100%" height="94%" align="right" style="border: none;" id="security">Failed to load iframes, maybe your browser doesn't support them?</iframe>
</div>

<noscript><style>body { display:none;}</style></noscript>

<div class="window qrScanWindow">
  <div id="qr1">
      <iframe name="qr1" src="" width="100%" height="100%" align="right" style="border-radius: 4px;"></iframe>
  </div>
</div>

<div class="window qrCodeWindow">
  <div id="qr2">
      <iframe name="qr2" src="" width="100%" height="100%" align="right" scrolling="auto" style="border-radius: 4px;"></iframe>
  </div>
</div>


<div class="window linksWindow">
  <div id="progs">
    <br><br><br>
    <a href="https://mail.google.com" target="_blank" class="largeButtons">Gmail</a>
    <a href="https://alfred.camera/webapp2/" target="_blank" class="largeButtons">Alfred</a>
    <a href="https://groups.google.com/forum/#!forum/npa-npa" target="_blank" class="largeButtons">Google Groups Forum</a>
    <a href="https://www.the-qrcode-generator.com/" target="_blank" class="largeButtons">QR Code Scanner</a>
  </div>
</div>


<div class="window todoWindow">
  <div id="todo">
    <iframe src="todo.html" width="100%" height="94%" align="right" style="border: none;" name="todo"></iframe>
  </div>
</div>
